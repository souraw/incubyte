-- Total Sales, Avg Transaction Amount and Total Transactions
SELECT
  SUM(TransactionAmount) AS TotalSales,
  AVG(TransactionAmount) AS AvgTransactionAmount,
  COUNT(TransactionID) AS TotalTransactions
FROM Assessment_Dataset
WHERE TransactionAmount > 0; -- Excluding refunds/returns

-- Total Sales by Payment Method
SELECT 
  PaymentMethod, 
  SUM(TransactionAmount) AS TotalSales
FROM Assessment_Dataset
GROUP BY PaymentMethod
ORDER BY TotalSales DESC;

-- Payment Method Distribution
SELECT 
  PaymentMethod, 
  COUNT(*) AS TransactionCount,
  ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM AssessmentDataset), 2) AS Percentage
FROM Assessment_Dataset
GROUP BY PaymentMethod
ORDER BY TransactionCount DESC;

-- Total Sales by Top 10 Cities
SELECT 
  City, 
  SUM(TransactionAmount) AS TotalSales
FROM Assessment_Dataset
WHERE TransactionAmount > 0
GROUP BY City
ORDER BY TotalSales DESC
LIMIT 10;

-- Total Sales by Store Type
SELECT 
  StoreType, 
  SUM(TransactionAmount) AS TotalSales
FROM Assessment_Dataset
WHERE TransactionAmount > 0
GROUP BY StoreType
ORDER BY TotalSales DESC;

-- Total Sales by Region
SELECT 
  Region, 
  SUM(TransactionAmount) AS RegionalSales
FROM Assessment_Dataset
WHERE TransactionAmount > 0
GROUP BY Region
ORDER BY RegionalSales DESC;

-- Sales by City and Region (Drill Down)
SELECT
  Region,
  City,
  SUM(TransactionAmount) AS CitySales
FROM Assessment_Dataset
WHERE TransactionAmount > 0
GROUP BY Region, City
ORDER BY Region, CitySales DESC;

-- Top 5 Products by Sales
SELECT 
  ProductName, 
  SUM(TransactionAmount) AS TotalSales
FROM Assessment_Dataset
WHERE TransactionAmount > 0
GROUP BY ProductName
ORDER BY TotalSales DESC
LIMIT 5;

